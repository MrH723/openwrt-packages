{"version":3,"sources":["webpack:///./src/hooks/useRemainingViewPortHeight.js","webpack:///./src/components/Search.module.css","webpack:///./src/components/Logs.module.css","webpack:///./src/api/logs.ts","webpack:///./node_modules/react-feather/dist/icons/search.js","webpack:///./src/components/Search.js","webpack:///./src/components/LogSearch.js","webpack:///./src/components/Logs.js"],"names":["useState","React","useRef","useCallback","useLayoutEffect","useRemainingViewPortHeight","ref","containerHeight","setContainerHeight","updateContainerHeight","top","current","getBoundingClientRect","window","innerHeight","addEventListener","removeEventListener","module","exports","apiConfigSnapshot","controller","wsState","endpoint","textDecoder","TextDecoder","even","fetched","decoded","appendData","s","callback","o","JSON","parse","err","console","log","now","Date","time","toLocaleString","id","Math","floor","random","toString","pump","reader","appendLog","read","then","done","value","str","decode","stream","splits","split","lastSplit","length","i","fetchLogs","apiConfig","url","buildWebSocketURL","ws","WebSocket","_ev","baseURL","secret","logLevel","abort","signal","AbortController","getURLAndInit","init","fetch","response","body","getReader","aborted","message","fetchLogsWithFetch","event","data","_extends","Object","assign","target","arguments","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","Search","_ref","_ref$color","color","_ref$size","size","rest","createElement","xmlns","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","cx","cy","r","x1","y1","x2","y2","propTypes","string","oneOfType","number","displayName","RuleSearch","dispatch","searchText","updateSearchText","text","setText","updateSearchTextInternal","v","updateSearchTextDebounced","useMemo","debounce","className","s0","RuleSearchContainer","inputWrapper","type","onChange","e","input","iconWrapper","connect","getSearchText","memo","useEffect","colors","debug","info","warning","error","LogLine","payload","logMeta","logTime","logType","style","backgroundColor","logText","itemKey","index","PropTypes","bool","Row","areEqual","logs","getLogsForDisplay","getLogLevel","getClashAPIConfig","appendLogInternal","refLogsContainer","ContentHeader","title","LogSearch","paddingBottom","logPlaceholder","logPlaceholderIcon","SvgYacd","logsWrapper","itemCount","itemSize","itemData"],"mappings":"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","file":"logs.cc50e5d3455225682ee1.js","sourcesContent":["import React from 'react';\n\nconst { useState, useRef, useCallback, useLayoutEffect } = React;\n\n/**\n * cosnt [ref, remainingHeight] = useRemainingViewPortHeight();\n *\n * return a reference, and the remaining height of the referenced dom node\n * to the bottom of the view port\n *\n */\nexport default function useRemainingViewPortHeight() {\n  const ref = useRef(null);\n  const [containerHeight, setContainerHeight] = useState(200);\n  const updateContainerHeight = useCallback(() => {\n    const { top } = ref.current.getBoundingClientRect();\n    setContainerHeight(window.innerHeight - top);\n  }, []);\n\n  useLayoutEffect(() => {\n    updateContainerHeight();\n    window.addEventListener('resize', updateContainerHeight);\n    return () => {\n      window.removeEventListener('resize', updateContainerHeight);\n    };\n  }, [updateContainerHeight]);\n\n  return [ref, containerHeight];\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"RuleSearch\":\"_2QPZldYe9U\",\"RuleSearchContainer\":\"_2PCUI90lIf\",\"inputWrapper\":\"xOYTLnYrng\",\"input\":\"_1JKQs_Qawx\",\"iconWrapper\":\"_2km92h_dfH\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"logMeta\":\"_3rlaagQhmO\",\"logType\":\"_1Y8l2FW3db\",\"logTime\":\"_3RhnPkHfE2\",\"logText\":\"o1S9cV4T0R\",\"logsWrapper\":\"_3GIdCSyyS7\",\"log\":\"lUDfnPiNdD\",\"logPlaceholder\":\"PaFzglKCf5\",\"logPlaceholderIcon\":\"_29b6nIu_GY\"};","import { ClashAPIConfig } from 'src/types';\n\nimport { buildWebSocketURL, getURLAndInit } from '../misc/request-helper';\n\ntype LogsAPIConfig = ClashAPIConfig & { logLevel: string };\ntype LogEntry = {\n  time?: string;\n  id?: string;\n  even?: boolean;\n  // and some other props\n};\ntype AppendLogFn = (x: LogEntry) => void;\n\nconst endpoint = '/logs';\nconst textDecoder = new TextDecoder('utf-8');\n\nconst getRandomStr = () => {\n  return Math.floor((1 + Math.random()) * 0x10000).toString(16);\n};\n\nlet even = false;\nlet fetched = false;\nlet decoded = '';\n\nfunction appendData(s: string, callback: AppendLogFn) {\n  let o: LogEntry;\n  try {\n    o = JSON.parse(s);\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.log('JSON.parse error', JSON.parse(s));\n  }\n\n  const now = new Date();\n  const time = now.toLocaleString('zh-Hans');\n  // mutate input param in place intentionally\n  o.time = time;\n  o.id = +now - 0 + getRandomStr();\n  o.even = even = !even;\n  callback(o);\n}\n\nfunction pump(reader: ReadableStreamDefaultReader, appendLog: AppendLogFn) {\n  return reader.read().then(({ done, value }) => {\n    const str = textDecoder.decode(value, { stream: !done });\n    decoded += str;\n\n    const splits = decoded.split('\\n');\n\n    const lastSplit = splits[splits.length - 1];\n\n    for (let i = 0; i < splits.length - 1; i++) {\n      appendData(splits[i], appendLog);\n    }\n\n    if (done) {\n      appendData(lastSplit, appendLog);\n      decoded = '';\n\n      // eslint-disable-next-line no-console\n      console.log('GET /logs streaming done');\n      fetched = false;\n      return;\n    } else {\n      decoded = lastSplit;\n    }\n    return pump(reader, appendLog);\n  });\n}\n\nlet apiConfigSnapshot: LogsAPIConfig;\nlet controller: AbortController;\n\n// 1 OPEN\n// other value CLOSED\n// similar to ws readyState but not the same\n// https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/readyState\nlet wsState: number;\nexport function fetchLogs(apiConfig: LogsAPIConfig, appendLog: AppendLogFn) {\n  if (fetched || wsState === 1) return;\n  wsState = 1;\n  const url = buildWebSocketURL(apiConfig, endpoint);\n  const ws = new WebSocket(url);\n  ws.addEventListener('error', () => (wsState = 3));\n  ws.addEventListener('close', function (_ev) {\n    wsState = 3;\n    fetchLogsWithFetch(apiConfig, appendLog);\n  });\n  ws.addEventListener('message', function (event) {\n    appendData(event.data, appendLog);\n  });\n}\n\nfunction fetchLogsWithFetch(apiConfig: LogsAPIConfig, appendLog: AppendLogFn) {\n  if (\n    controller &&\n    (apiConfigSnapshot.baseURL !== apiConfig.baseURL ||\n      apiConfigSnapshot.secret !== apiConfig.secret ||\n      apiConfigSnapshot.logLevel !== apiConfig.logLevel)\n  ) {\n    controller.abort();\n  } else if (fetched) {\n    return;\n  }\n\n  fetched = true;\n  apiConfigSnapshot = { ...apiConfig };\n\n  controller = new AbortController();\n  const signal = controller.signal;\n\n  const { url, init } = getURLAndInit(apiConfig);\n  fetch(url + endpoint + '?level=' + apiConfig.logLevel, {\n    ...init,\n    signal,\n  }).then(\n    (response) => {\n      const reader = response.body.getReader();\n      pump(reader, appendLog);\n    },\n    (err) => {\n      fetched = false;\n      if (signal.aborted) return;\n\n      // eslint-disable-next-line no-console\n      console.log('GET /logs error:', err.message);\n    }\n  );\n}\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React, { forwardRef } from 'react';\nimport PropTypes from 'prop-types';\nvar Search = forwardRef(function (_ref, ref) {\n  var _ref$color = _ref.color,\n      color = _ref$color === void 0 ? 'currentColor' : _ref$color,\n      _ref$size = _ref.size,\n      size = _ref$size === void 0 ? 24 : _ref$size,\n      rest = _objectWithoutProperties(_ref, [\"color\", \"size\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    ref: ref,\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: size,\n    height: size,\n    viewBox: \"0 0 24 24\",\n    fill: \"none\",\n    stroke: color,\n    strokeWidth: \"2\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }, rest), /*#__PURE__*/React.createElement(\"circle\", {\n    cx: \"11\",\n    cy: \"11\",\n    r: \"8\"\n  }), /*#__PURE__*/React.createElement(\"line\", {\n    x1: \"21\",\n    y1: \"21\",\n    x2: \"16.65\",\n    y2: \"16.65\"\n  }));\n});\nSearch.propTypes = {\n  color: PropTypes.string,\n  size: PropTypes.oneOfType([PropTypes.string, PropTypes.number])\n};\nSearch.displayName = 'Search';\nexport default Search;","import debounce from 'lodash-es/debounce';\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { Search as SearchIcon } from 'react-feather';\n\nimport s0 from './Search.module.css';\n\nfunction RuleSearch({ dispatch, searchText, updateSearchText }) {\n  const [text, setText] = useState(searchText);\n  const updateSearchTextInternal = useCallback(\n    (v) => {\n      dispatch(updateSearchText(v));\n    },\n    [dispatch, updateSearchText]\n  );\n  const updateSearchTextDebounced = useMemo(\n    () => debounce(updateSearchTextInternal, 300),\n    [updateSearchTextInternal]\n  );\n  const onChange = (e) => {\n    setText(e.target.value);\n    updateSearchTextDebounced(e.target.value);\n  };\n\n  return (\n    <div className={s0.RuleSearch}>\n      <div className={s0.RuleSearchContainer}>\n        <div className={s0.inputWrapper}>\n          <input\n            type=\"text\"\n            value={text}\n            onChange={onChange}\n            className={s0.input}\n          />\n        </div>\n        <div className={s0.iconWrapper}>\n          <SearchIcon size={20} />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default RuleSearch;\n","import { getSearchText, updateSearchText } from '../store/logs';\nimport Search from './Search';\nimport { connect } from './StateProvider';\n\nconst mapState = (s) => ({ searchText: getSearchText(s), updateSearchText });\nexport default connect(mapState)(Search);\n","import cx from 'clsx';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { areEqual, FixedSizeList as List } from 'react-window';\n\nimport { fetchLogs } from '../api/logs';\nimport useRemainingViewPortHeight from '../hooks/useRemainingViewPortHeight';\nimport { getClashAPIConfig } from '../store/app';\nimport { getLogLevel } from '../store/configs';\nimport { appendLog, getLogsForDisplay } from '../store/logs';\nimport ContentHeader from './ContentHeader';\nimport s0 from './Logs.module.css';\nimport LogSearch from './LogSearch';\nimport { connect } from './StateProvider';\nimport SvgYacd from './SvgYacd';\n\nconst { useCallback, memo, useEffect } = React;\n\nconst paddingBottom = 30;\nconst colors = {\n  debug: 'none',\n  // debug: '#8a8a8a',\n  info: '#454545',\n  // info: '#147d14',\n  warning: '#b99105',\n  error: '#c11c1c',\n};\n\nfunction LogLine({ time, even, payload, type }) {\n  const className = cx({ even }, s0.log);\n  return (\n    <div className={className}>\n      <div className={s0.logMeta}>\n        <div className={s0.logTime}>{time}</div>\n        <div className={s0.logType} style={{ backgroundColor: colors[type] }}>\n          {type}\n        </div>\n        <div className={s0.logText}>{payload}</div>\n      </div>\n    </div>\n  );\n}\n\nLogLine.propTypes = {\n  time: PropTypes.string,\n  even: PropTypes.bool,\n  payload: PropTypes.string,\n  type: PropTypes.string,\n};\n\nfunction itemKey(index, data) {\n  const item = data[index];\n  return item.id;\n}\n\nconst Row = memo(({ index, style, data }) => {\n  const r = data[index];\n  return (\n    <div style={style}>\n      <LogLine {...r} />\n    </div>\n  );\n}, areEqual);\n\nfunction Logs({ dispatch, logLevel, apiConfig, logs }) {\n  const appendLogInternal = useCallback(\n    (log) => {\n      dispatch(appendLog(log));\n    },\n    [dispatch]\n  );\n  useEffect(() => {\n    fetchLogs({ ...apiConfig, logLevel }, appendLogInternal);\n  }, [apiConfig, logLevel, appendLogInternal]);\n  const [refLogsContainer, containerHeight] = useRemainingViewPortHeight();\n\n  return (\n    <div>\n      <ContentHeader title=\"Logs\" />\n      <LogSearch />\n      <div ref={refLogsContainer} style={{ paddingBottom }}>\n        {logs.length === 0 ? (\n          <div\n            className={s0.logPlaceholder}\n            style={{ height: containerHeight - paddingBottom }}\n          >\n            <div className={s0.logPlaceholderIcon}>\n              <SvgYacd width={200} height={200} />\n            </div>\n            <div>No logs yet, hang tight...</div>\n          </div>\n        ) : (\n          <div className={s0.logsWrapper}>\n            <List\n              height={containerHeight - paddingBottom}\n              width=\"100%\"\n              itemCount={logs.length}\n              itemSize={80}\n              itemData={logs}\n              itemKey={itemKey}\n            >\n              {Row}\n            </List>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nconst mapState = (s) => ({\n  logs: getLogsForDisplay(s),\n  logLevel: getLogLevel(s),\n  apiConfig: getClashAPIConfig(s),\n});\n\nexport default connect(mapState)(Logs);\n"],"sourceRoot":""}